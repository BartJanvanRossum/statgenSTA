---
title: "QTL analysis using RAP"
author: "Bart-Jan van Rossum"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette:
    toc: false
bibliography: bibliography.bib
vignette: >
  %\VignetteIndexEntry{QTL analysis using RAP}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
  
```{r setup, include = FALSE}
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.dim = c(7, 5)
)
library(RAP)
```

```{r, include = FALSE}
## Recreate data from last step in RAP vignette.
data("wheatChl")
wheatTD <- createTD(data = wheatChl, 
                    genotype = "trt_id", repId = "rep", subBlock = "bl", 
                    rowCoord = "row", colCoord = "col")
modWheatSpTot <- STRunModel(TD = wheatTD, traits = "GY", what = "fixed", design = "res.rowcol")
```

## QTL Analysis using the RAP package

The RAP package is developed as an easy to use package for analysing data of 
plant breeding experiments with plenty of options for plotting and reporting 
the results of the analyses.  

The package has 3 main components:

* Modeling trial data for single trials and extracting results
* Genotype by Environment (GxE) analysis
* QTL analysis

This vignette deals with the QTL mapping part of the package and describes in 
detail how to perform such an analysis.

---

## Data preparation

The functions in the RAP package for QTL analysis are essentially wrappers for functions in the qtl package [@Broman2003]. To start a QTL analysis as in the qtl package an object of class ```cross``` needs to be constructed. This can be done using the ````read.cross``` function from the qtl package (see ```help(read.cross, package = "qtl")```) on how to do this.  
A more convenient way is to directly convert the output of a model fitted using ```STRunModel``` into an object of class cross using the function ```SSAtoCross```. For the examp

```{r createCross}
cr1 <- SSAtoCross(SSA = modWheatSpTot, trial = "C_SWS_12",  
                  what = "BLUEs", genoFile = system.file("extdata", "markersWheatChl.csv", package = "RAP"), na.strings = c("N", "H"))
```
```{r qualContr}
#QTLMapQC(cross = cr1)
```


----

## References
