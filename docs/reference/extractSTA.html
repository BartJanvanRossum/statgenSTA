<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extract statistics from fitted models — extractSTA • statgenSTA</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Extract statistics from fitted models — extractSTA" />
<meta property="og:description" content="Extract and calculate various results for fitted models such as BLUEs, BLUPs,
unit errors and heritabilities. For a full list of results that can be
extracted, see Details.
The result(s) to extract are specified in what. If a single result is
extracted, if possible, this result is returned as a data.frame. If this is
not possible, the result is returned as a list. If multiple results are
extracted at the same time, these are always returned as a list. Where
relevant, this behavior can be changed by specifying asDataFrame.
Results that are returned as data.frame are marked as such in the data.frame
column in the table in Details.
Most results can only be calculated if a model is fitted with genotype as
fixed or with genotype as random. E.g. to compute heritabilies a model should
be fitted with genotype as random effect. This is indicated in the list
in Details with &quot;F&quot; and &quot;R&quot; respectively." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statgenSTA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-seedling"></span>
     
    other packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://biometris.github.io/statgenGWAS">statgenGWAS</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/Biometris/statgenSTA">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract statistics from fitted models</h1>
    <small class="dont-index">Source: <a href='https://github.com/Biometris/statgenSTA/blob/master/R/extractSTA.R'><code>R/extractSTA.R</code></a></small>
    <div class="hidden name"><code>extractSTA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extract and calculate various results for fitted models such as BLUEs, BLUPs,
unit errors and heritabilities. For a full list of results that can be
extracted, see Details.<br /><br />
The result(s) to extract are specified in <code>what</code>. If a single result is
extracted, if possible, this result is returned as a data.frame. If this is
not possible, the result is returned as a list. If multiple results are
extracted at the same time, these are always returned as a list. Where
relevant, this behavior can be changed by specifying <code>asDataFrame</code>.
Results that are returned as data.frame are marked as such in the data.frame
column in the table in Details.<br /><br />
Most results can only be calculated if a model is fitted with genotype as
fixed or with genotype as random. E.g. to compute heritabilies a model should
be fitted with genotype as random effect. This is indicated in the list
in Details with "F" and "R" respectively.</p>
    </div>

    <pre class="usage"><span class='fu'>extractSTA</span>(
  <span class='kw'>STA</span>,
  trials = <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='kw'>STA</span>),
  traits = <span class='kw'>NULL</span>,
  what = <span class='st'>"all"</span>,
  asDataFrame = <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='kw'>what</span>) <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>&amp;&amp;</span> <span class='kw'>what</span> != <span class='st'>"all"</span>,
  keep = <span class='kw'>NULL</span>,
  restoreColNames = <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>STA</th>
      <td><p>An object of class STA.</p></td>
    </tr>
    <tr>
      <th>trials</th>
      <td><p>A character vector of trials for which the statistics should be
computed. If not supplied, statistics are computed for all trials that have
been modeled.</p></td>
    </tr>
    <tr>
      <th>traits</th>
      <td><p>A character vector of traits for which the statistics should be
computed. If not supplied, statistics are computed for all traits that have
been modeled.</p></td>
    </tr>
    <tr>
      <th>what</th>
      <td><p>A character vector indicating which statistics should be
computed. Most statistics are available for all models, some only for models
fitted using a certain engine. If this is the case, this is indicated in the
list with options in details.<br />
If <code>what = "all"</code>, all available statistics are computed.</p></td>
    </tr>
    <tr>
      <th>asDataFrame</th>
      <td><p>Should the output be reshaped to a data.frame. This is
only possible if the number of statistics to extract is one.</p></td>
    </tr>
    <tr>
      <th>keep</th>
      <td><p>A character vector of column(s) in the object of class
<code><a href='TD.html'>TD</a></code> used for modeling. These columns will be kept as output when
computing fitted values, residuals, standardized residuals and rMeans.
Columns can also be kept when computing (se)BLUEs and (se)BLUPs but only if
the column to keep contains unique values for the modeled variables, i.e. a
column repId with several different values per genotype cannot be kept.</p></td>
    </tr>
    <tr>
      <th>restoreColNames</th>
      <td><p>Should the original column names be restored in the
output of the extracted data?</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with, per trial for which statistics have been extracted, a
list of those statistics.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Possible options for <code>what</code> are:</p><table class='table'>
<tr><td>result</td><td>model</td><td>description</td><td>data.frame</td></tr>
<tr><td>BLUEs</td><td>F</td><td>Best Linear Unbiased Estimators</td><td>yes</td></tr>
<tr><td>seBLUEs</td><td>F</td><td>standard errors of the BLUEs</td><td>yes</td></tr>
<tr><td>ue</td><td>F</td><td>unit errors - only for lme4 and asreml</td><td>yes</td></tr>
<tr><td>varCompF</td><td>F</td><td>variance components for the model with genotype as fixed component</td><td></td></tr>
<tr><td>fitted</td><td>F</td><td>fitted values for the model with genotype as fixed component</td><td>yes</td></tr>
<tr><td>residF</td><td>F</td><td>residuals for the model with genotype as fixed component</td><td>yes</td></tr>
<tr><td>stdResF</td><td>F</td><td>standardized residuals for the model with genotype as fixed component</td><td>yes</td></tr>
<tr><td>wald</td><td>F</td><td>results of the wald test - only for lme4 and asreml</td><td></td></tr>
<tr><td>CV</td><td>F</td><td>Coefficient of Variation - only for lme4 and asreml</td><td>yes</td></tr>
<tr><td>rDfF</td><td>F</td><td>residual degrees of freedom for the model with genotype as fixed component</td><td>yes</td></tr>
<tr><td>sed</td><td>F</td><td>standard error of difference - only for asreml</td><td></td></tr>
<tr><td>lsd</td><td>F</td><td>least significant difference - only for asreml</td><td></td></tr>
<tr><td>BLUPs</td><td>R</td><td>Best Linear Unbiased Predictors</td><td>yes</td></tr>
<tr><td>seBLUPs</td><td>R</td><td>standard errors of the BLUPs</td><td>yes</td></tr>
<tr><td>heritability</td><td>R</td><td>broad sense heritability</td><td>yes</td></tr>
<tr><td>varCompR</td><td>R</td><td>variance components for the model with genotype as random component</td><td></td></tr>
<tr><td>varGen</td><td>R</td><td>genetic variance component</td><td>yes</td></tr>
<tr><td>varErr</td><td>R</td><td>residual variance component</td><td>yes</td></tr>
<tr><td>varSpat</td><td>R</td><td>spatial variance components - only for SpATS</td><td></td></tr>
<tr><td>rMeans</td><td>R</td><td>fitted values for the model with genotype as random component</td><td>yes</td></tr>
<tr><td>ranEf</td><td>R</td><td>random genetic effects</td><td>yes</td></tr>
<tr><td>residR</td><td>R</td><td>residuals for the model with genotype as random component</td><td>yes</td></tr>
<tr><td>stdResR</td><td>R</td><td>standardized residuals for the model with genotype as random component</td><td>yes</td></tr>
<tr><td>rDfR</td><td>R</td><td>residual degrees of freedom for the model with genotype as random component</td><td>yes</td></tr>
<tr><td>effDim</td><td>R</td><td>effective dimensions - only for SpATS</td><td></td></tr>
<tr><td>ratEffDim</td><td>R</td><td>ratios of the effective dimensions - only for SpATS</td><td></td></tr>
</table>


    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='fitTD.html'>fitTD</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Fit model using SpATS.</span>
<span class='kw'>myModel</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fitTD.html'>fitTD</a></span>(TD = <span class='kw'>TDHeat05</span>, design = <span class='st'>"res.rowcol"</span>, traits = <span class='st'>"yield"</span>)
</div><div class='output co'>#&gt; <span class='message'>Using SpATS for fitting models.</span></div><div class='input'>
<span class='co'>## Extract all available statistics from the fitted model.</span>
<span class='kw'>extr</span> <span class='op'>&lt;-</span> <span class='fu'>extractSTA</span>(<span class='kw'>myModel</span>)

<span class='co'>## Extract only the BLUEs from the fitted model.</span>
<span class='kw'>BLUEs</span> <span class='op'>&lt;-</span> <span class='fu'>extractSTA</span>(<span class='kw'>myModel</span>, what = <span class='st'>"BLUEs"</span>)

<span class='co'>## Extract only the BLUEs from the fitted model and keep trial as variable in</span>
<span class='co'>## the output.</span>
<span class='kw'>BLUEs2</span> <span class='op'>&lt;-</span> <span class='fu'>extractSTA</span>(<span class='kw'>myModel</span>, what = <span class='st'>"BLUEs"</span>, keep = <span class='st'>"trial"</span>)

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


