<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot function for class TD — plot.TD • statgenSTA</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot function for class TD — plot.TD" />
<meta property="og:description" content="Plotting function for objects of class TD. Plots either the layout of the
different trials within the TD object or locates the trials on a map. Also a
boxplot can be made for selected traits and trials, a plot of correlations
between trials and a scatter plot matrix. A detailed description and optional
extra parameters of the different plots is given in the sections below." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statgenSTA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fas fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-seedling"></span>
     
    other packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://biometris.github.io/statgenGxE">statgenGxE</a>
    </li>
    <li>
      <a href="https://biometris.github.io/statgenGWAS">statgenGWAS</a>
    </li>
    <li>
      <a href="https://biometris.github.io/statgenHTP">statgenHTP</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/Biometris/statgenSTA">
    <span class="fas fa-github fa-lg fab"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot function for class TD</h1>
    <small class="dont-index">Source: <a href='https://github.com/Biometris/statgenSTA/blob/master/R/createTD.R'><code>R/createTD.R</code></a></small>
    <div class="hidden name"><code>plot.TD.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plotting function for objects of class TD. Plots either the layout of the
different trials within the TD object or locates the trials on a map. Also a
boxplot can be made for selected traits and trials, a plot of correlations
between trials and a scatter plot matrix. A detailed description and optional
extra parameters of the different plots is given in the sections below.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for TD</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>...</span>,
  plotType <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"layout"</span>, <span class='st'>"map"</span>, <span class='st'>"box"</span>, <span class='st'>"cor"</span>, <span class='st'>"scatter"</span><span class='op'>)</span>,
  trials <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  traits <span class='op'>=</span> <span class='cn'>NULL</span>,
  title <span class='op'>=</span> <span class='cn'>NULL</span>,
  output <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object of class TD.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Extra plot options. Described per plotType in their respective
section.</p></td>
    </tr>
    <tr>
      <th>plotType</th>
      <td><p>A single character string indicating which plot should be
made. See the sections below for a detailed explanation of the plots.</p></td>
    </tr>
    <tr>
      <th>trials</th>
      <td><p>A character vector indicating which trials to include in the
plot.</p></td>
    </tr>
    <tr>
      <th>traits</th>
      <td><p>A character vector indicating for which traits a plot should
be made. Ignored if <code>plotType</code> = "map".</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p>A character string used a title for the plot. Note that when
a title is specified and multiple plots are created, all plots will get the
same title.</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>Should the plot be output to the current device? If
<code>FALSE</code> only a list of ggplot objects is invisibly returned.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="layout-plot"><a class="anchor" href="#layout-plot"></a>Layout Plot</h2>

    

<p>Plots the layout of the selected trials.
This plot can only be made for trials that contain both row (<code>rowCoord</code>)
and column (<code>colCoord</code>) information. If either one of those is missing
the trial is skipped with a warning. If blocks (<code>subBlock</code>) are
available for a trial these can be colored in different colors per block by
setting <code>colorSubBlock = TRUE</code>. If replicates (<code>repId</code>) are
available a black line is plotted between different replicates. Missing plots
are indicated in white. These can either be single plots in a trial or
complete missing columns or rows.<br />
Extra parameter options:</p><dl>
<dt>showGeno</dt><dd><p>Should individual genotypes be indicated as text in the plot?
Defaults to <code>FALSE</code></p></dd>
<dt>sizeGeno</dt><dd><p>The text size for indicating individual genotypes. Defaults
to 2. Ignored if <code>showGeno = FALSE</code>.</p></dd>
<dt>highlight</dt><dd><p>A character vector of genotypes to be highlighted in the
plot.</p></dd>
<dt>colHighlight</dt><dd><p>A character vector specifying colors to use for the
highlighted genotypes. If not specified, default ggplot colors are used.</p></dd>
<dt>colorSubBlock</dt><dd><p>Should blocks be colored with a different color per
subBlock? Defaults to <code>FALSE</code>. <code>colorSubBlock</code> is ignored when
highlight is used to highlight genotypes.</p></dd>
<dt>colSubBlock</dt><dd><p>A character vector specifying colors to use for the
subBlocks. If not specified, default ggplot colors are used.</p></dd>

</dl>

    <h2 class="hasAnchor" id="map-plot"><a class="anchor" href="#map-plot"></a>Map Plot</h2>

    

<p>A map is plotted with the locations of the trials in the TD object.
Mapping the trials is done based on latitude and longitude that can be
added when creating an object of class TD. Trials for which either latitude
or longitude is not available are skipped with a warning message.
The countries in which the trials are located will be plotted on a single
map and the location of the trials will be indicated on this map. The
actual plot is made using ggplot, but for getting the data for the borders
of the countries the maps package is needed.<br />
Extra parameter options:</p><dl>
<dt>colorTrialBy</dt><dd><p>A character string indicating a column in <code>TD</code> by
which the trials on the map are colored.</p></dd>
<dt>colTrial</dt><dd><p>A character vector with plot colors for the trials. A
single color when <code>colorTrialBy = NULL</code>, a vector of colors otherwise.</p></dd>
<dt>printTrialNames</dt><dd><p>Should trial names be printed. Defaults to
<code>TRUE</code>. Setting this to <code>FALSE</code> can be useful if there are many
trials.</p></dd>
<dt>minLatRange</dt><dd><p>A positive numerical value indicating the minimum range
(in degrees) for the latitude on the plotted map. Defaults to 10.</p></dd>
<dt>minLongRange</dt><dd><p>A positive numerical value indicating the minimum range
(in degrees) for the longitude on the plotted map. Defaults to 5.</p></dd>

</dl>

    <h2 class="hasAnchor" id="box-plot"><a class="anchor" href="#box-plot"></a>Box Plot</h2>

    

<p>Creates a boxplot per selected trait grouped by trial. Extra parameter
options:</p><dl>
<dt>groupBy</dt><dd><p>A character string indicating a column in <code>TD</code> by which
the boxes in the plot should be grouped. By default the boxes are grouped
per trial.</p></dd>
<dt>colorTrialBy</dt><dd><p>A character string indicating a column in <code>TD</code> by
which the boxes are colored. Coloring will be done within the groups
indicated by the <code>groupBy</code> parameter.</p></dd>
<dt>colTrial</dt><dd><p>A character vector with plot colors for the trials. A
single color when <code>colorTrialBy = NULL</code>, a vector of colors otherwise.</p></dd>
<dt>orderBy</dt><dd><p>A character string indicating the way the boxes should be
ordered. Either "alphabetic" for alphabetical ordering of the groups,
"ascending" for ordering by ascending mean, or "descending" for ordering by
descending mean. Default boxes are ordered alphabetically.</p></dd>

</dl>

    <h2 class="hasAnchor" id="correlation-plot"><a class="anchor" href="#correlation-plot"></a>Correlation Plot</h2>

    

<p>Draws a heat map of correlations between trials per selected trait. If
genotypes are replicated within trials genotypic means are taken before
computing correlations. The order of the trials in the heat map is determined
by clustering them. Closely related trials will be plotted close to each
other.</p>
    <h2 class="hasAnchor" id="scatter-plot"><a class="anchor" href="#scatter-plot"></a>Scatter Plot</h2>

    

<p>Draws a scatter plot matrix per selected trait. If genotypes are replicated
within trials genotypic means are taken before plotting. The lower left of
the matrix contains scatter plots between trials. The diagonal contains
histograms of the data per trial.<br />
Extra parameter options:</p><dl>
<dt>colorGenoBy</dt><dd><p>A character string indicating a column in <code>TD</code> by
which the genotypes in the scatter plots are colored.</p></dd>
<dt>colGeno</dt><dd><p>A character vector with plot colors for the genotypes. A
single color when <code>colorGenoBy = NULL</code>, a vector of colors otherwise.</p></dd>
<dt>colorTrialBy</dt><dd><p>A character string indicating a column in <code>TD</code> by
which the trials in the histograms are colored.</p></dd>
<dt>colTrial</dt><dd><p>A character vector with plot colors for the trials. A
single color when <code>colorTrialBy = NULL</code>, a vector of colors otherwise.</p></dd>
<dt>trialOrder</dt><dd><p>A character vector indicating the order of the trials in
the plot matrix (left to right and top to bottom). This vector should be a
permutation of all trials plotted.</p></dd>
<dt>addCorr</dt><dd><p>A character string indicating the position of the correlation
between trials displayed in each plot, either "tl" for top left, "tr", for
top right, "bl" for bottom left or "br" for bottom right. If <code>NULL</code>,
the default, then no correlation is added to the plot.</p></dd>

</dl>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other functions for TD objects: 
<code><a href='TD.html'>TD</a></code>,
<code><a href='getMeta.html'>getMeta</a>()</code>,
<code><a href='summary.TD.html'>summary.TD</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"dropsRaw"</span><span class='op'>)</span>

<span class='co'>## Create a TD object.</span>
<span class='va'>dropsTD</span> <span class='op'>&lt;-</span> <span class='fu'><a href='TD.html'>createTD</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>dropsRaw</span><span class='op'>[</span><span class='va'>dropsRaw</span><span class='op'>$</span><span class='va'>year</span> <span class='op'>==</span> <span class='fl'>2012</span>, <span class='op'>]</span>,
                    genotype <span class='op'>=</span> <span class='st'>"Variety_ID"</span>,
                    trial <span class='op'>=</span> <span class='st'>"Experiment"</span>,
                    loc <span class='op'>=</span> <span class='st'>"Site"</span>,
                    repId <span class='op'>=</span> <span class='st'>"Replicate"</span>,
                    subBlock <span class='op'>=</span> <span class='st'>"block"</span>,
                    rowCoord <span class='op'>=</span> <span class='st'>"Row"</span>,
                    colCoord <span class='op'>=</span> <span class='st'>"Column"</span>,
                    trLat <span class='op'>=</span> <span class='st'>"Lat"</span>,
                    trLong <span class='op'>=</span> <span class='st'>"Long"</span><span class='op'>)</span>

<span class='co'>### Layout plot.</span>

<span class='co'># \donttest{</span>
<span class='co'>## Plot the layout of one of the trials.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dropsTD</span>,
    trials <span class='op'>=</span> <span class='st'>"Kar12W"</span><span class='op'>)</span>
</div><div class='img'><img src='plot.TD-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Highlight some of the genotypes in the layout.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dropsTD</span>,
     trials <span class='op'>=</span> <span class='st'>"Kar12W"</span>,
     highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A3"</span>, <span class='st'>"11430"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='plot.TD-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>### Map plot.</span>

<span class='co'>## Plot the location of the trials on the map.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dropsTD</span>,
     plotType <span class='op'>=</span> <span class='st'>"map"</span><span class='op'>)</span>
</div><div class='img'><img src='plot.TD-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>### Box plot.</span>

<span class='co'>## Create a box plot for grain.yield.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dropsTD</span>,
     plotType <span class='op'>=</span> <span class='st'>"box"</span>,
     traits <span class='op'>=</span> <span class='st'>"grain.yield"</span><span class='op'>)</span>
</div><div class='img'><img src='plot.TD-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Add coloring by scenarioFull to the boxes.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dropsTD</span>,
     plotType <span class='op'>=</span> <span class='st'>"box"</span>,
     traits <span class='op'>=</span> <span class='st'>"grain.yield"</span>,
     colorTrialBy <span class='op'>=</span> <span class='st'>"scenarioFull"</span><span class='op'>)</span>
</div><div class='img'><img src='plot.TD-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Sort the boxes in descending order.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dropsTD</span>,
     plotType <span class='op'>=</span> <span class='st'>"box"</span>,
     traits <span class='op'>=</span> <span class='st'>"grain.yield"</span>,
     orderBy <span class='op'>=</span> <span class='st'>"descending"</span><span class='op'>)</span>
</div><div class='img'><img src='plot.TD-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>### Correlation plot.</span>

<span class='co'>## Plot the correlations between trials for grain.yield.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dropsTD</span>,
     plotType <span class='op'>=</span> <span class='st'>"cor"</span>,
     traits <span class='op'>=</span> <span class='st'>"grain.yield"</span><span class='op'>)</span>
</div><div class='img'><img src='plot.TD-7.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>### Scatter plot</span>

<span class='co'>## Plot scatter plot for grain.yield.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dropsTD</span>,
    plotType <span class='op'>=</span> <span class='st'>"scatter"</span>,
    traits <span class='op'>=</span> <span class='st'>"grain.yield"</span><span class='op'>)</span>
</div><div class='img'><img src='plot.TD-8.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Create a scatter plot matrix for grain yield.</span>
<span class='co'>## Color trials by scenario and genotypes by family.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dropsTD</span>,
     plotType <span class='op'>=</span> <span class='st'>"scatter"</span>,
     traits <span class='op'>=</span> <span class='st'>"grain.yield"</span>,
     colorTrialBy <span class='op'>=</span> <span class='st'>"scenarioFull"</span>,
     colorGenoBy <span class='op'>=</span> <span class='st'>"geneticGroup"</span><span class='op'>)</span>
</div><div class='img'><img src='plot.TD-9.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


